import sqlite3
import pathlib
# 連接 SQLite 資料庫
# 此函式返回 SQLite 連線 (conn) 和游標 (cursor)
def get_db_connection():
    base_path = pathlib.Path(__file__).parent  # 獲取當前腳本所在目錄
    db_path = base_path / "BIBIGOproject" 
    conn = sqlite3.connect(db_path / "db.sqlite3")  # 連接 SQLite 資料庫
    cursor = conn.cursor()
    return conn, cursor

def re_category():
    conn, cursor = get_db_connection()
    # 設定條件與對應值
    update_mapping = {
        1: "食品、飲品", 2: "食品、飲品", 3: "食品、飲品", 4: "食品、飲品", 5: "食品、飲品",
        6: "食品、飲品", 7: "食品、飲品", 8: "食品、飲品", 9: "食品、飲品", 10: "食品、飲品",
        11: "食品、飲品", 12: "食品、飲品", 13: "食品、飲品", 14: "食品、飲品", 15: "食品、飲品",
        16: "食品、飲品", 17: "食品、飲品", 18: "食品、飲品", 19: "食品、飲品", 20: "食品、飲品",
        21: "食品、飲品", 22: "3C、電器", 23: "3C、電器", 24: "3C、電器", "25": "3C、電器",
        26: "3C、電器", 27: "3C、電器", 28: "3C、電器", 29: "3C、電器", 30: "3C、電器",
        31: "3C、電器", 32: "3C、電器", 33: "3C、電器", 34: "3C、電器", 35: "3C、電器",
        36: "3C、電器", 37: "美妝、生活", 38: "美妝、生活", 39: "美妝、生活", 40: "美妝、生活",
        41: "藥品、保健", 42: "藥品、保健", 43: "嬰兒、寵物", 44: "嬰兒、寵物", 45: "嬰兒、寵物",
        46: "嬰兒、寵物", 47: "運動、休閒", 48: "嬰兒、寵物", 49: "運動、休閒", 50: "運動、休閒",
        51: "運動、休閒", 52: "運動、休閒", 53: "文具、玩具", 54: "文具、玩具", 55: "運動、休閒",
        56: "五金、雜貨", 57: "運動、休閒", 58: "美妝、生活", 59: "美妝、生活", 60: "食品、飲品",
        61: "五金、雜貨", 62: "五金、雜貨", 63: "傢俱、廚具", 64: "傢俱、廚具", 65: "傢俱、廚具",
        66: "傢俱、廚具", 67: "五金、雜貨", 68: "傢俱、廚具", 69: "傢俱、廚具", 70: "傢俱、廚具",
        71: "傢俱、廚具", 72: "衣服、飾品", 73: "衣服、飾品", 74: "衣服、飾品", 75: "衣服、飾品",
        76: "衣服、飾品", 77: "衣服、飾品", 78: "衣服、飾品", 79: "衣服、飾品", 80: "衣服、飾品",
        81: "衣服、飾品", 82: "衣服、飾品", 83: "衣服、飾品", 84: "衣服、飾品", 85: "食品、飲品",
        86: "食品、飲品", 87: "食品、飲品", 88: "食品、飲品", 89: "3C、電器", 90: "3C、電器",
        91: "3C、電器", 92: "3C、電器", 93: "3C、電器", 94: "3C、電器", 95: "3C、電器",
        96: "3C、電器", 97: "3C、電器", 98: "藥品、保健", 99: "藥品、保健", 100: "藥品、保健",
        101: "美妝、生活", 102: "美妝、生活", 103: "嬰兒、寵物", 104: "文具、玩具", 105: "衣服、飾品",
        106: "衣服、飾品", 107: "衣服、飾品", 108: "衣服、飾品", 109: "衣服、飾品", 110: "衣服、飾品",
        111: "衣服、飾品", 112: "衣服、飾品", 113: "傢俱、廚具", 114: "傢俱、廚具", 115: "五金、雜貨",
        116: "五金、雜貨", 117: "衣服、飾品", 118: "衣服、飾品", 119: "衣服、飾品", 120: "衣服、飾品",
        121: "衣服、飾品", 122: "運動、休閒", 123: "運動、休閒", 124: "運動、休閒", 125: "運動、休閒",
        126: "運動、休閒", 127: "文具、玩具", 128: "文具、玩具", 129: "美妝、生活", 130: "美妝、生活",
        131: "美妝、生活", 132: "美妝、生活", 133: "美妝、生活", 134: "美妝、生活", 135: "美妝、生活",
        136: "美妝、生活", 137: "藥品、保健", 138: "衣服、飾品", 139: "衣服、飾品", 140: "衣服、飾品",
        141: "食品、飲品", 142: "嬰兒、寵物", 143: "3C、電器", 144: "五金、雜貨", 145: "五金、雜貨",
        146: "運動、休閒", 147: "文具、玩具", 148: "傢俱、廚具", 149: "五金、雜貨", 150: "傢俱、廚具",
        151: "美妝、生活"
    }
    
    # 逐筆更新
    for category_id, value in update_mapping.items():
       cursor.execute("UPDATE myapp_product SET value = ? WHERE category_id = ? AND (value IS NULL OR value = '')", 
                       (value, category_id)
                       )

    # 提交變更並關閉連線
    conn.commit()
    conn.close()
    print("欄位更新完成！")
re_category()
# conn, cursor = get_db_connection()
# cursor.execute(
#     "UPDATE myapp_product SET value = NULL"
# )
# conn.commit()
# conn.close()